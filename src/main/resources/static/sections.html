<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Subject Sections</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    /* ----------- Fonts ----------- */
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600&family=Poppins:wght@600&display=swap');

    /* ----------- Body & Background ----------- */
    body {
        font-family: 'Inter', sans-serif;
        color: #f4f4f9;
        margin: 0;
        padding: 0;
        min-height: 100vh;
        background: linear-gradient(135deg, #1e1e2f, #12121c, #2c2c54);
        background-size: 400% 400%;
        animation: bgShift 6s ease infinite;
        padding-top: 70px; /* Space for navbar */
        overflow-x: hidden;
    }

    @keyframes bgShift {
        0% { background-position: 0% 50%; }
        50% { background-position: 100% 50%; }
        100% { background-position: 0% 50%; }
    }

    /* ----------- Navbar ----------- */
    .navbar {
        background: rgba(255,255,255,0.06) !important;
        border-bottom: 1px solid rgba(255,255,255,0.1);
        backdrop-filter: blur(12px);
        box-shadow: 0 2px 6px rgba(0,0,0,0.25);
    }

    .navbar-brand,
    .nav-link {
        color: #00e0ff !important;
        font-weight: 600;
        font-family: 'Poppins', sans-serif;
        text-shadow: 0 0 4px rgba(0,224,255,0.3);
    }

    /* ----------- Heading ----------- */
    h1 {
        color: #00e0ff;
        font-size: 2rem;
        margin-top: 20px;
        font-weight: 600;
        text-shadow: 0 0 4px rgba(0,224,255,0.4), 1px 1px 2px rgba(0,0,0,0.3);
    }

    /* ----------- Roadmap ----------- */
    .roadmap {
        display: flex;
        align-items: center;
        justify-content: start;
        gap: 30px;
        margin-top: 50px;
        flex-wrap: wrap;
    }

    .roadmap-step {
        text-align: center;
        padding: 15px 20px;
        border-radius: 14px;
        background: rgba(255,255,255,0.06);
        border: 1px solid rgba(255,255,255,0.15);
        backdrop-filter: blur(10px);
        min-width: 120px;
        position: relative;
        transition: transform 0.2s ease, box-shadow 0.2s ease;
        color: #f4f4f9;
        font-weight: bold;
        cursor: pointer;
        box-shadow: 0 3px 8px rgba(0,224,255,0.1);
    }

    .roadmap-step:hover {
        transform: scale(1.05);
        box-shadow: 0 6px 15px rgba(0,224,255,0.2);
        border-color: rgba(0,224,255,0.25);
    }

    /* Gradient text utility */
    .gradient-text {
        background: linear-gradient(90deg, #ffffff, #c0c0c0);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        color: transparent;
    }

    /* Special colors for start & end */
    .roadmap-step.bg-success {
        background: linear-gradient(45deg, #00e676, #00c853);
        border: none;
    }
    .roadmap-step.bg-success span {
        display: inline-block;
        background: linear-gradient(90deg, #ffffff, #c0c0c0);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
    }

    .roadmap-step.bg-danger {
        background: linear-gradient(45deg, #ff1744, #d50000);
        border: none;
    }
    .roadmap-step.bg-danger span {
        display: inline-block;
        background: linear-gradient(90deg, #ffffff, #c0c0c0);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
    }

    /* Step arrows */
    .roadmap-step::after {
        content: 'â†’';
        position: absolute;
        right: -25px;
        top: 50%;
        transform: translateY(-50%);
        font-size: 20px;
        color: #00e0ff;
    }
    .roadmap-step:last-child::after { content: ''; }

    /* ----------- Back Button ----------- */
    #backBtn {
        position: absolute;
        top: 15px;
        right: 15px;
        z-index: 10;
        background: linear-gradient(45deg, #00e0ff, #7b2ff7);
        border: none;
        color: #fff;
        font-weight: bold;
        border-radius: 8px;
        padding: 8px 16px;
        transition: transform 0.2s ease, box-shadow 0.2s ease;
    }

    #backBtn:hover {
        transform: scale(1.05);
        box-shadow: 0 4px 12px rgba(123,47,247,0.2);
    }
  </style>
</head>
<body>

<nav class="navbar navbar-expand-lg fixed-top">
  <div class="container-fluid">
    <a class="navbar-brand" href="#">LEARNIFY</a>
    <button id="backBtn" class="btn">Back to Dashboard</button>
  </div>
</nav>

<div class="container text-center">
  <h1 id="subjectTitle"></h1>
  <div id="roadmap" class="roadmap"></div>
</div>

<script>
  document.addEventListener('DOMContentLoaded', async function () {
      const urlParams = new URLSearchParams(window.location.search);
      const subjectId = urlParams.get('subjectId');
      const subjectName = urlParams.get('subjectName') || 'Unknown Subject';

      const roadmapContainer = document.getElementById('roadmap');
      const subjectTitle = document.getElementById('subjectTitle');
      const backBtn = document.getElementById('backBtn');

      subjectTitle.textContent = `Learning Path: ${subjectName}`;

      backBtn.addEventListener('click', () => {
          window.location.href = 'learnerDashboard.html';
      });

      if (!subjectId) {
          alert('Invalid subject. Please go back and select a subject.');
          window.location.href = 'learnerDashboard.html';
          return;
      }

      // Start step
      const startStep = document.createElement('div');
      startStep.className = 'roadmap-step bg-success';
      startStep.innerHTML = '<span>Start</span>';
      roadmapContainer.appendChild(startStep);

      try {
          const response = await fetch(`http://localhost:8081/Sections/SectionsBySubject/${subjectId}`);
          const sections = await response.json();

          if (!Array.isArray(sections) || sections.length === 0) {
              const noSection = document.createElement('div');
              noSection.textContent = 'No sections found for this subject';
              noSection.className = 'gradient-text mt-3';
              roadmapContainer.appendChild(noSection);
          } else {
              // Add sections
              sections.forEach(sec => {
                  const step = document.createElement('div');
                  step.className = 'roadmap-step';
                  step.textContent = sec.sectionName;
                  step.addEventListener('click', () => {
                      window.location.href = `topics.html?sectionId=${sec.sectionId}&sectionName=${encodeURIComponent(sec.sectionName)}`;
                  });
                  roadmapContainer.appendChild(step);
              });
          }

          // End step
          const endStep = document.createElement('div');
          endStep.className = 'roadmap-step bg-danger';
          endStep.innerHTML = '<span>End</span>';
          roadmapContainer.appendChild(endStep);

      } catch (error) {
          console.error('Error fetching sections:', error);
          const errorMsg = document.createElement('div');
          errorMsg.textContent = 'Failed to load sections. Please try again later.';
          errorMsg.className = 'gradient-text mt-3';
          roadmapContainer.appendChild(errorMsg);
      }
  });
</script>
</body>
</html>